#include <stdio.h>
#include <string.h>

int keys[SIZE];
char names[SIZE][20];
long long phones[SIZE];

void initialize() {
    for (int i = 0; i < SIZE; i++) {
        keys[i] = -1; // -1 means empty
        strcpy(names[i], "----");
        phones[i] = 0;
    }
}


int hash(int key) {
    return key % SIZE;
}


void insert(int key, char name[], long long phone) {
    int index = hash(key);
    int i = 0;

    while (keys[(index + i) % SIZE] != -1 && i < SIZE)
        i++;

    if (i < SIZE) {
        int pos = (index + i) % SIZE;
        keys[pos] = key;
        strcpy(names[pos], name);
        phones[pos] = phone;
        printf("\nRecord inserted successfully!");
    } else {
        printf("\nHash table is full!");
    }
}


void search(int key) {
    int index = hash(key);
    int i = 0;

    while (i < SIZE) {
        int pos = (index + i) % SIZE;
        if (keys[pos] == key) {
            printf("\nRecord Found:");
            printf("\nName: %s", names[pos]);
            printf("\nPhone: %lld\n", phones[pos]);
            return;
        }
        i++;
    }
    printf("\nRecord not found!");
}


void display() {
    printf("\n\nIndex\tKey\tName\t\tPhone");
    printf("\n---------------------------------------");
    for (int i = 0; i < SIZE; i++) {
        if (keys[i] != -1)
            printf("\n%d\t%d\t%-10s\t%lld", i, keys[i], names[i], phones[i]);
        else
            printf("\n%d\t--\t(empty)", i);
    }
    printf("\n");
}


int main() {
    int choice, key;
    char name[20];
    long long phone;

    initialize();

    do {
        printf("\n\n==== Telephone Directory Menu ====");
        printf("\n1. Insert Record");
        printf("\n2. Search Record");
        printf("\n3. Display Directory");
        printf("\n4. Exit");
        printf("\nEnter your choice: ");
        scanf("%d", &choice);

        switch (choice) {
            case 1:
                printf("\nEnter key (ID): ");
                scanf("%d", &key);
                printf("Enter name: ");
                scanf("%s", name);
                printf("Enter phone number: ");
                scanf("%lld", &phone);
                insert(key, name, phone);
                break;

            case 2:
                printf("\nEnter key (ID) to search: ");
                scanf("%d", &key);
                search(key);
                break;

            case 3:
                display();
                break;

            case 4:
                printf("\nExiting program...");
                break;

            default:
                printf("\nInvalid choice!");
        }
    } while (choice != 4);

    return 0;
}
